[![N|Solid](https://www.maib.md/images/logo.svg)](https://www.maib.md)

# Модуль Maib Payment Gateway для платфморы Magento 2
Этот плагин позволяет интегрировать ваш Magento 2 интернет-магазин с **maib e-commerce API** для приема онлайн-платежей (Visa/Mastercard/Google Pay/Apple Pay).

## Описание
Подробнее об этапах интеграции и требованиях к сайту можно узнать [здесь](https://docs.maibmerchants.md/ru/etapy-i-trebovaniya-k-integracii).

Чтобы протестировать интеграцию, вам понадобятся данные доступа к тестовому проекту (Project ID / Project Secret / Signature Key). Для этого просим вас отправить запрос на электронную почту: ecom@maib.md.

Для осуществления реальных платежей вам необходимо заключить договор e-commerce и выполнить как минимум одну успешную транзакцию, используя данные тестового проекта и данные карты для тестирования.

После подписания договора вы получите доступ к платформе maibmerchants и сможете активировать Производственный Проект.

## Функционал
**Платежи онлайн**: Visa / Mastercard / Apple Pay / Google Pay.

**Три валюты**: MDL / USD / EUR (в зависимости от настроек вашего проекта).

**Возврат платежа**:
Для возврата платежа необходимо:
1. Найдите необходимый заказ в списке заказов (_Продажи_ -> _Заказы_) и откройте его.
2. Сделайте так, чтобы у вашего заказа был счет-фактура (если нет, вам нужно будет создать его с помощью кнопки _Счет_ (см. _refund-1.png_)).
3. После отправки счета вам потребуется доступ к _Счетам_ (см. _refund-2.png_).
4. Нажмите, чтобы выставить счет, который вы видите на странице.
5. Нажмите _Кредитовое авизо_ (см. _refund-3.png_).
6. Нажмите кнопку _Возврат_ (см. _refund-4.png_).
7. Сумма платежа будет возвращена на карту клиента.

## Требования
- Регистрация на платформе maibmerchants.md
- Magento 2 платформа
- Расширения _curl_ и _json_ включены

## Установка (см. _settings-general.png_)
1. Загрузите файл расширения из репозитория Github или Magento.
2. В панели администратора/интерфейсе администратора Magento 2 перейдите в раздел _Магазины_ -> _Конфигурация_ -> _Продажи_ -> _Способы оплаты_.
3. Найдите модуль **Модуль платежного шлюза Maib** в списке (_Другие способы оплаты_).
4. Выберите _Да_ в поле _Активирован_, и Magento 2 начнет процесс установки, чтобы модуль начал работать.

## Настройки (см. _settings-maibmerchants.png_ и _settings-order-status.png_)
1. Project ID - Project ID из Проекта (Тестовый или Производственный) в maibmerchants.
2. Project Secret -  Project Secret из Проекта (Тестовый или Производственный) в maibmerchants. Доступен после активации проекта.
3. Signature Key - Signature Key из Проекта (Тестовый или Производственный) в maibmerchants. Доступен после активации проекта.
4. Ok URL / Fail URL / Callback URL - добавьте эти ссылки в соответствующие поля в настройках Проекта в maibmerchants.
5. Настройки статуса заказа: Платеж в ожидании - Статус заказа, когда платеж находится в ожидании.
6. Настройки статуса заказа: Успешная оплата - Статус заказа после успешного завершения платежа.
7. Настройки статуса заказа: Неуспешная оплата - Статус заказа при неуспешной оплаты.
8. Настройки статуса заказа: Возврат платежа - Статус заказа при возврате платежа. Для возврата платежа обновите статус заказа до этого выбранного статуса.

## Отладка
Если вам требуется дополнительная помощь, обращайтесь в службу поддержки ecommerce **Модуль платежного шлюза Maib**, отправив сообщние по адресу ecom@maib.md.

В письме обязательно укажите следующую информацию:
- Название компании
- Project ID
- Дата и время транзакции с ошибками
- Ошибки из файла с логами